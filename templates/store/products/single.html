{% extends "store/base.html" %}
{% load static %}
{% block title %}
{{ product.name }}
{% endblock %}
{% block content %}


<!-- Product Detail -->
<div class="small-container single-product">
    <div class="row g-3">
        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor" class="bi bi-info-circle me-2"
        viewBox="0 0 16 16"><path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z" />
        <path
          d="M8.93 6.588l-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533L8.93 6.588zM9 4.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0z" />
      </svg> FOOD ALLERGY WARNING! Please read discription before purchasing this product.
    </div>
    <div class="row"> 
        <div class="col-1">
            <img src="{{ product.image.url }}">
        </div>
        <div class="col-21">
            <p>KETO</p>
            <h1>{{ product.title }}</h1>
            <div class="price"><span class="h4 fw-bold">${{ product.price }}</span></div>
            <label for="select">Qty</label>
                                <select id="select">
                                    <option value="1">1</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5">5</option>
                                    <option value="6">6</option>
                                    <option value="7">7</option>
                                    <option value="8">8</option>
                                    <option value="9">9</option>
                                </select>
                                <div class="add-to-basket">
                                    <button type="button" id="add-button" value="{{product.id}}" class="btn btn-success btn-sm">Add to basket</button>
                                    <button type="button" id="add-button" value="{{product.id}}" class="btn btn-light fw500">Add to Favorites</button>
                                </div>
        </div>
        <div class="col-22">
            <h3>Details</h3>
            <p>Cajun Roast chicken baked on a bed of potatoes and vegetables.</p>
            <h3>Ingredients</h3>
            <p>{{ product.description|slice:":500" }}...</p>
        </div>
        </div>
    </div>
</div>

<!-- Reviews -->
<div class="container mt-5">
    <h5 class="text-uppercase font-weight-bold">Customer Reviews</h5>
    <hr class="mt-0 pt-0">
    <div class="row">
        <div class="col-sm-7 mt-2">
            {% for review in reviews %}
            <div class="review-heading">
                <a><i class="fas fa-user">{{ review.user }}</i></a>
                <a><i class="far fa-user"></i>{{ review.subject }}</a>
                <a class="m1-2"><i class="far fa-clock mr-1"></i>{{ review.created_at }}</a>
            </div>
            <div class="review-body mt-2">
                <p>{{ review.review }}</p>
            </div>
            {% endfor %}
        </div>
        <div class="col-sm-5 mt-2">
            <form class="col s12" method="POST" action="" role="form">
                {% csrf_token %}       
                <label>How do you rate this meal?</label>
                    <div class="rate">
                        <input type="radio" name="rate" id="rating10" value="5" required><label for="rating10" title="5"></label>
                        <input type="radio" name="rate" id="rating9" value="4.5" required><label for="rating9" title="4.5" class="half"></label>
                        <input type="radio" name="rate" id="rating8" value="4" required><label for="rating8" title="4"></label>
                        <input type="radio" name="rate" id="rating7" value="3.5" required><label for="rating7" title="3.5" class="half"></label>
                        <input type="radio" name="rate" id="rating6" value="3" required><label for="rating6" title="3"></label>
                        <input type="radio" name="rate" id="rating5" value="2.5" required><label for="rating5" title="2.5" class="half"></label>
                        <input type="radio" name="rate" id="rating4" value="2" required><label for="rating4" title="2"></label>
                        <input type="radio" name="rate" id="rating3" value="1.5" required><label for="rating3" title="1.5" class="half"></label>
                        <input type="radio" name="rate" id="rating2" value="1" required><label for="rating2" title="1"></label>
                        <input type="radio" name="rate" id="rating1" value="0.5" required><label for="rating1" title="0.5" class="half"></label>
                    </div>

                    <input type="text" class="form-control" name="subject" placeholder="Your Name">
                    <br>
                    <textarea name="review" rows="4" class="form-control" placeholder="Write Your Review"></textarea>
                    <br>
                    <input type="submit" value="Submit Review" class="btn btn-danger btn-md m-0" >
                    <br>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- Product Detail Style -->
<style>
.row{
    display: flex;
    flex-wrap: wrap;
    justify-content: space-around;
    padding-left: 70px;
    padding-right: 70px;
}
.single-product{
    margin-top: auto;
}
.single-product .col-1{
    display: flex;
    align-items: center;
    justify-content: space-around;
}
.single-product .col-1 img{
    height: 60%;
}
.col-1{
    display: flex;
    align-items: center;
    justify-content: space-between;
}
.single-product .col-21{
    text-align: center;
    padding: 40px 20px;
    margin: 20px;
    box-shadow: 0 0 20px 0px rgba(0,0,0,0.1);
}
.single-product .col-22{
    text-align: center;
    padding: 40px 20px;
    box-shadow: 0 0 20px 0px rgba(0,0,0,0.1);
}

.col-21{
    padding-left: 50px;
    padding-right: 500px;
}
.col-21 input{
    text-align: center;
    max-width: 41px;
    margin: 10px;
}
.col-21 h1{
    font-size: 32px;
    margin: 24px 0;
    color: #555;
}
.col-21 p{
    font-size: 20px;
    padding: 0px;
    color: #555;
}
.col-21 h4{
    font-weight: 400;
    font-size: 20px;
    padding: 0px;
    color: #555;
}
.col-22 p{
    font-size: 12px;
    margin: 12px 0;
    color: #777;
}
.col-22 h3{
    font-weight: 600;
    color: #555;
    font-size: 18px;
    margin-top: 15px;
}
.price{
    margin-bottom: 10px;
}
.add-to-basket{
    margin-top: 13px;
}

/* Rating */
.rate > input{
    display: none;
}
.rate{
    margin-bottom: 2.5rem;
    border: 0;
}
.rate > label{
    float: right;
}
.rate > label:before{
    display: inline-block;
    font-size: 1.1rem;
    font-family: FontAwesome;
    content: "\f005";
    margin: 0;
    padding: 0.3rem .2rem;
    cursor: pointer;
}
.rate .half:before{
    content: "\f089";
    position: absolute;
    padding-right: 0;
}
input:checked ~ label, label:hover ~ label{
    color: #ffb503;
}
input:checked + label:hover, input:checked ~ label:hover, input:checked ~ label:hover ~ label, label:hover ~ input:checked ~ label{
    color: #cc9000;
}

</style>



<!--ajax request to add product to basket using the button. this will bring data from the DB to the front-->
<script> 
    $(document).on('click', '#add-button', function (e) {
        e.preventDefault();
        $.ajax({
            type: 'POST',
            url: '{% url "basket:basket_add" %}',
            data: {
                productid: $('#add-button').val(),
                productqty: $('#select option:selected').text(),
                csrfmiddlewaretoken: "{{csrf_token}}",
                action: 'post'
            },
            success: function (json) {
                document.getElementById("basket-qty").innerHTML = json.qty
            },
            error: function (xhr, errmsg, err) {}
        });
    })



</script>
{% endblock %}